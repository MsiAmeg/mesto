(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r(o.key),o)}}function n(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===t(n)?n:String(n)}var o=function(){function t(e,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n(this,"enableValidation",(function(){o._setEventListeners()})),n(this,"_setEventListeners",(function(){o._inputList=Array.from(o._formElement.querySelectorAll(o._config.inputSelector)),o._buttonForm=o._formElement.querySelector(o._config.submitButtonSelector),o._toggleButtonState(),o._inputList.forEach((function(t){t.addEventListener("input",(function(){o._checkInputValidity(t,o._config),o._toggleButtonState()}))}))})),n(this,"_toggleButtonState",(function(){o._hasInvalidInput()?o.disableSubmitBtn():(o._buttonForm.classList.remove(o._config.inactiveButtonClass),o._buttonForm.removeAttribute("disabled"))})),n(this,"_hasInvalidInput",(function(){return o._inputList.some((function(t){return!t.validity.valid}))})),n(this,"_showInputError",(function(t,e){var n=o._formElement.querySelector(".".concat(t.id,"-error"));n.textContent=e,n.classList.add(o._config.errorClass)})),n(this,"_hideInputError",(function(t,e){var n=o._formElement.querySelector(".".concat(t.id,"-error"));n.textContent="",n.classList.remove(o._config.errorClass)})),n(this,"_checkInputValidity",(function(t){t.validity.valid?o._hideInputError(t,t.validationMessage):o._showInputError(t,t.validationMessage)})),this._config=e,this._formElement=r}var r,o;return r=t,(o=[{key:"disableSubmitBtn",value:function(){this._buttonForm.classList.add(this._config.inactiveButtonClass),this._buttonForm.setAttribute("disabled","")}},{key:"resetValidation",value:function(){var t=this;this.disableSubmitBtn(),this._inputList.forEach((function(e){t._hideInputError(e)}))}}])&&e(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),t}();function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===i(o)?o:String(o)),r)}var o}var a=function(){function t(e,n){var r=e.data,o=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._renderedItems=r,this._renderer=o,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"setItem",value:function(t){this._container.prepend(t)}},{key:"clear",value:function(){this._container.innerHTML=""}},{key:"renderItems",value:function(){var t=this;this.clear(),this._renderedItems.forEach((function(e){t._renderer(e)}))}}])&&u(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function s(t,e,n){return(e=f(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t){var e=function(t,e){if("object"!==c(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===c(e)?e:String(e)}var p=function(){function t(e,n,r,o,i,u,a,c,l,f){var p=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,"_getTemplate",(function(){return document.querySelector(p._templateSelector).content.querySelector(".card").cloneNode(!0)})),s(this,"_setEventListeners",(function(){p._cardImage=p._element.querySelector(".card__image"),p._cardTitle=p._element.querySelector(".card__title"),p._likeBtn=p._element.querySelector(".card__like"),p._likeCountEl=p._element.querySelector(".card__like-count"),p._trashBtn=p._element.querySelector(".card__trash"),p._cardImage.addEventListener("click",(function(){p._handleCardClick(p._name,p._link)})),p._likeBtn.addEventListener("click",p._likeCard)})),s(this,"generateCard",(function(){return p._element=p._getTemplate(),p._setEventListeners(),p._ownerChecks(),p._cardImage.alt=p._name,p._cardImage.src=p._link,p._cardTitle.textContent=p._name,console.log(p._likeCount),p._likeCountEl.textContent=p._likeCount,p._element})),this._name=e,this._link=n,this._templateSelector=r,this._handleCardClick=o,this._likeCard=this._likeCard.bind(this),this._deleteCard=this._deleteCard.bind(this),this._isOwner=i==u,this._userId=u,this._cardId=a,this._handleDeleteCard=c,this._likeCount=l.length,this._likes=l,console.log(this._likes),this._handleLikeClick=f}var e,n;return e=t,(n=[{key:"_likeCard",value:function(){var t=this._likeBtn.classList.contains("card__like_active");this._handleLikeClick(this._cardId,t,this)}},{key:"likeClick",value:function(t){this._likeBtn.classList.add("card__like_active"),this._likeCountEl.textContent=t}},{key:"unlikeClick",value:function(t){this._likeBtn.classList.remove("card__like_active"),this._likeCountEl.textContent=t}},{key:"_deleteCard",value:function(){this._handleDeleteCard(this._cardId,this._element)}},{key:"_ownerChecks",value:function(){var t=this;this._isOwner?this._trashBtn.addEventListener("click",this._deleteCard):this._trashBtn.remove(),this._likes.forEach((function(e){e._id==t._userId&&t._likeBtn.classList.add("card__like_active")}))}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==y(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===y(o)?o:String(o)),r)}var o}var m=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._handleXClose=this._handleXClose.bind(this),this.open=this.open.bind(this),this.close=this.close.bind(this)}var e,n;return e=t,(n=[{key:"open",value:function(){this.setEventListeners(),this._popupElement.classList.add("popup_opened")}},{key:"close",value:function(){this.removeEventListeners(),this._popupElement.classList.remove("popup_opened")}},{key:"_handleXClose",value:function(t){(t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__close-button"))&&this.close()}},{key:"_handleEscClose",value:function(t){"Escape"===t.key&&this.close()}},{key:"setEventListeners",value:function(){document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("mousedown",this._handleXClose)}},{key:"removeEventListeners",value:function(){document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("mousedown",this._handleXClose)}}])&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==d(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===d(o)?o:String(o)),r)}var o}function _(){return _="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},_.apply(this,arguments)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(r);if(o){var n=g(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}(this,t)});function u(t,e){var n,r=e.handleFormSumbit;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t))._handleFormSumbit=r,n._formSubmit=n._formSubmit.bind(S(n)),n}return e=u,(n=[{key:"open",value:function(t,e){_(g(u.prototype),"open",this).call(this),this._cardId=t,this._cardEl=e}},{key:"_formSubmit",value:function(t){t.preventDefault(),this._handleFormSumbit(this._cardId,this._cardEl)}},{key:"setEventListeners",value:function(){_(g(u.prototype),"setEventListeners",this).call(this),this._popupElement.addEventListener("submit",this._formSubmit)}},{key:"removeEventListeners",value:function(){_(g(u.prototype),"removeEventListeners",this).call(this),this._popupElement.removeEventListener("submit",this._formSubmit)}}])&&v(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(m);function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==w(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===w(o)?o:String(o)),r)}var o}function j(){return j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=O(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},j.apply(this,arguments)}function C(t,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},C(t,e)}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}var P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=O(r);if(o){var n=O(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._popupImagePic=e._popupElement.querySelector(".popup__image"),e._popupCaption=e._popupElement.querySelector(".popup__caption"),e}return e=u,(n=[{key:"open",value:function(t,e){this._popupImagePic.src=e,this._popupImagePic.alt=t,this._popupCaption.textContent=t,j(O(u.prototype),"open",this).call(this)}}])&&E(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(m);function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==L(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===L(o)?o:String(o)),r)}var o}function T(){return T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=q(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},T.apply(this,arguments)}function R(t,e){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},R(t,e)}function B(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function q(t){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},q(t)}var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=q(r);if(o){var n=q(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return B(t)}(this,t)});function u(t,e){var n,r=e.handleFormSumbit;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t))._formSubmit=n._formSubmit.bind(B(n)),n._handleFormSumbit=r,n._popupForm=n._popupElement.querySelector("form"),n._formInputs=Array.from(n._popupElement.querySelectorAll(".popup__input")),n._submitBtn=n._popupElement.querySelector(".popup__button"),n}return e=u,(n=[{key:"_getInputValues",value:function(){var t={};return this._formInputs.forEach((function(e){t[e.name]=e.value})),t}},{key:"_submitBtnText",value:function(t){this._submitBtn.textContent=t}},{key:"_formSubmit",value:function(t){var e=this;t.preventDefault();var n=this._submitBtn.textContent;this._submitBtnText("Сохранение..."),this._handleFormSumbit(this._getInputValues()).then((function(){return e.close()})).finally((function(){e._submitBtnText(n)}))}},{key:"setEventListeners",value:function(){T(q(u.prototype),"setEventListeners",this).call(this),this._popupElement.addEventListener("submit",this._formSubmit)}},{key:"removeEventListeners",value:function(){T(q(u.prototype),"removeEventListeners",this).call(this),this._popupElement.removeEventListener("submit",this._formSubmit)}},{key:"close",value:function(){T(q(u.prototype),"close",this).call(this),this._popupForm.reset()}}])&&I(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(m);function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==z(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===z(o)?o:String(o)),r)}var o}var F=function(){function t(e){var n=e.profileNameSelector,r=e.profileInfoSelector,o=e.profilePictureSelector;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._profileName=document.querySelector(n),this._profileInfo=document.querySelector(r),this._profilePicture=document.querySelector(o)}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{nameInput:this._profileName.textContent,jobInput:this._profileInfo.textContent}}},{key:"setUserInfo",value:function(t){var e=t.name,n=t.about;this._profileName.textContent=e,this._profileInfo.textContent=n}},{key:"setUserAvatar",value:function(t){var e=t.avatar;this._profilePicture.src=e}}])&&A(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==D(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===D(o)?o:String(o)),r)}var o}var V=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._url=e.url,this._authorization=e.authorization,this._cohort=e.cohort}var e,n;return e=t,(n=[{key:"_renderResponse",value:function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._url,"v1/").concat(this._cohort,"/cards"),{headers:{authorization:this._authorization}}).then(this._renderResponse)}},{key:"setCard",value:function(t){var e=t.name,n=t.link;return fetch("".concat(this._url,"v1/").concat(this._cohort,"/cards"),{method:"POST",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:n})}).then(this._renderResponse)}},{key:"deleteCard",value:function(t){return fetch("".concat(this._url,"v1/").concat(this._cohort,"/cards/").concat(t),{method:"DELETE",headers:{authorization:this._authorization}}).then(this._renderResponse)}},{key:"getUserData",value:function(){return fetch("".concat(this._url,"v1/").concat(this._cohort,"/users/me"),{headers:{authorization:this._authorization}}).then(this._renderResponse)}},{key:"setUserData",value:function(t){var e=t.name,n=t.about;return fetch("".concat(this._url,"v1/").concat(this._cohort,"/users/me"),{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:n})}).then(this._renderResponse)}},{key:"setUserAvatar",value:function(t){var e=t.avatar;return fetch("".concat(this._url,"v1/").concat(this._cohort,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(this._renderResponse)}},{key:"setLike",value:function(t){return fetch("".concat(this._url,"v1/").concat(this._cohort,"/cards/").concat(t,"/likes"),{method:"PUT",headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then(this._renderResponse)}},{key:"deleteLike",value:function(t){return fetch("".concat(this._url,"v1/").concat(this._cohort,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then(this._renderResponse)}}])&&U(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),N=document.querySelector(".profile__edit-button"),X=document.querySelector(".profile__avatar"),M=document.querySelector(".profile__add-button"),H=document.querySelector(".popup_edit-profile"),J=document.forms["profile-form"],$=H.querySelector(".popup__input_data_name"),G=H.querySelector(".popup__input_data_job"),K=document.querySelector(".popup_edit-avatar"),Q=document.querySelector(".popup_add-card"),W=document.forms["card-form"],Y=Q.querySelector(".popup__input_data_card-title"),Z=Q.querySelector(".popup__input_data_image"),tt={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input-error",errorClass:"popup__input-error_visible"};function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var nt,rt,ot=new V({url:"https://mesto.nomoreparties.co/",authorization:"c0e56340-d4b4-40f3-996d-780e6ca9c44e",cohort:"cohort-60"});function it(t,e,n,r,o,i){return new p(t,e,"#card",ut,n,r,o,at,i,ct).generateCard()}function ut(t,e){vt.open(t,e)}function at(t,e){dt.open(t,e)}function ct(t,e,n){e?ot.deleteLike(t).then((function(t){n.unlikeClick(t.likes.length)})).catch((function(t){console.log(t)})):ot.setLike(t).then((function(t){n.likeClick(t.likes.length)})).catch((function(t){console.log(t)}))}N.addEventListener("click",(function(){var t,e,n;e=(t=lt.getUserInfo()).nameInput,n=t.jobInput,$.value=e,G.value=n,st.resetValidation(),st.disableSubmitBtn(),yt.open()})),X.addEventListener("click",(function(){pt.resetValidation(),pt.disableSubmitBtn(),ht.open()})),M.addEventListener("click",(function(){ft.resetValidation(),mt.open()}));var lt=new F({profileNameSelector:".profile__title",profileInfoSelector:".profile__description",profilePictureSelector:".profile__picture"}),st=new o(tt,J);st.enableValidation();var ft=new o(tt,W);ft.enableValidation();var pt=new o(tt,K);pt.enableValidation();var yt=new x(".popup_edit-profile",{handleFormSumbit:function(t){var e=t.job,n=t.fullName;return ot.setUserData({name:n,about:e}).then((function(){lt.setUserInfo({name:n,about:e})})).catch((function(t){console.log(t)}))}}),ht=new x(".popup_edit-avatar",{handleFormSumbit:function(t){var e=t.avatar;return ot.setUserAvatar({avatar:e}).then((function(){lt.setUserAvatar({avatar:e})})).catch((function(t){console.log(t)}))}}),mt=new x(".popup_add-card",{handleFormSumbit:function(){var t=Y.value,e=Z.value;return ot.setCard({name:t,link:e}).then((function(t){var e=it(t.name,t.link,t.owner._id,nt,t._id,t.likes);rt.setItem(e)})).catch((function(t){console.log(t)}))}}),dt=new k(".popup_delete-card",{handleFormSumbit:function(t,e){ot.deleteCard(t).then((function(){dt.close(),e.remove()})).catch((function(t){console.log(t)}))}}),vt=new P(".popup_large-image"),_t=ot.getUserData(),bt=ot.getInitialCards();Promise.all([_t,bt]).then((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,a=[],c=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw o}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];lt.setUserAvatar(o),lt.setUserInfo(o),nt=o._id,(rt=new a({data:i,renderer:function(t){var e=it(t.name,t.link,t.owner._id,nt,t._id,t.likes);rt.setItem(e)}},".cards-grid")).renderItems()})).catch((function(t){console.log(t)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ekIsR0FBU2MsY0FBY1UsR0FDdkJ4QixHQUFTYSxZQUFZVyxHQUNyQjVKLEdBQVM0SixFQUFTdkgsS0FJbEJtRixHQUFZLElBQUkzSSxFQUFRLENBQ3RCRSxLQUFNOEssRUFDTjdLLFNBQVUsU0FBQ0ssR0FDVCxJQUFNa0UsRUFBU21FLEdBQVdySSxFQUFRTSxLQUFNTixFQUFRTyxLQUFNUCxFQUFRK0osTUFBTS9HLElBQUtyQyxHQUFRWCxFQUFRZ0QsSUFBS2hELEVBQVErQyxPQUN0R29GLEdBQVU2QixRQUFROUYsRUFDcEIsR0FDQyxnQkFDT3VHLGFBQ1osSUFDQzlCLE9BQU0sU0FBQUMsR0FDTDNHLFFBQVFDLElBQUkwRyxFQUNkLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBEZWxldGUuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpe1xyXG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZVN1Ym1pdEJ0bigpIHtcclxuICAgIHRoaXMuX2J1dHRvbkZvcm0uY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9idXR0b25Gb3JtLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xyXG4gIH07XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuZGlzYWJsZVN1Ym1pdEJ0bigpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2NvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgICB0aGlzLl9idXR0b25Gb3JtID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsLCB0aGlzLl9jb25maWcpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZVN1Ym1pdEJ0bigpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkZvcm0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkZvcm0ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCA9ICgpID0+IHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWwudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICAgIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsLCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgICAgY29uc3QgZXJyb3JFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgIGVycm9yRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsLCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgICAgY29uc3QgZXJyb3JFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgICBlcnJvckVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gICAgfTtcclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dEVsKSA9PiB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBkYXRhLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMgPSBkYXRhO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICBzZXRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuY2xlYXIoKTtcblxuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKG5hbWUsIGxpbmssIHRlbXBsYXRlU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgY2FyZE93bmVySWQsIHVzZXJJZCwgY2FyZElkLCBoYW5kbGVEZWxldGVDYXJkLCBsaWtlQ291bnQsIGhhbmRsZUxpa2VDbGljayl7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2xpa2VDYXJkID0gdGhpcy5fbGlrZUNhcmQuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9kZWxldGVDYXJkID0gdGhpcy5fZGVsZXRlQ2FyZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2lzT3duZXIgPSBjYXJkT3duZXJJZCA9PSB1c2VySWQgPyB0cnVlIDogZmFsc2U7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgIHRoaXMuX2NhcmRJZCA9IGNhcmRJZDtcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcbiAgICB0aGlzLl9saWtlQ291bnQgPSBsaWtlQ291bnQubGVuZ3RoO1xuICAgIHRoaXMuX2xpa2VzID0gbGlrZUNvdW50O1xuICAgIGNvbnNvbGUubG9nKHRoaXMuX2xpa2VzKTtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUgPSAoKSA9PiB7XG4gICAgY29uc3QgY2FyZEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJykuY2xvbmVOb2RlKHRydWUpO1xuICAgIHJldHVybiBjYXJkRWw7XG4gIH1cblxuICBfbGlrZUNhcmQoKSB7XG4gICAgY29uc3QgaXNMaWtlZCA9IHRoaXMuX2xpa2VCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19saWtlX2FjdGl2ZScpO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzLl9jYXJkSWQsIGlzTGlrZWQsIHRoaXMpO1xuICB9XG5cbiAgbGlrZUNsaWNrKGxpa2VzKSB7XG4gICAgdGhpcy5fbGlrZUJ0bi5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlX2FjdGl2ZScpO1xuICAgIHRoaXMuX2xpa2VDb3VudEVsLnRleHRDb250ZW50ID0gbGlrZXM7XG4gIH1cblxuICB1bmxpa2VDbGljayhsaWtlcykge1xuICAgICAgdGhpcy5fbGlrZUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdjYXJkX19saWtlX2FjdGl2ZScpO1xuICAgICAgdGhpcy5fbGlrZUNvdW50RWwudGV4dENvbnRlbnQgPSBsaWtlcztcbiAgfVxuXG4gIF9kZWxldGVDYXJkKCl7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLl9jYXJkSWQsIHRoaXMuX2VsZW1lbnQpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJyk7XG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKTtcbiAgICB0aGlzLl9saWtlQnRuID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZScpO1xuICAgIHRoaXMuX2xpa2VDb3VudEVsID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudCcpO1xuICAgIHRoaXMuX3RyYXNoQnRuID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdHJhc2gnKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2xpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9saWtlQ2FyZCk7XG4gIH1cblxuICBfb3duZXJDaGVja3MoKSB7XG4gICAgaWYgKHRoaXMuX2lzT3duZXIpe1xuICAgICAgdGhpcy5fdHJhc2hCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9kZWxldGVDYXJkKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLl90cmFzaEJ0bi5yZW1vdmUoKTtcbiAgICB9XG4gICAgdGhpcy5fbGlrZXMuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgIGlmIChlbGVtZW50Ll9pZCA9PSB0aGlzLl91c2VySWQpe1xuICAgICAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2VfYWN0aXZlJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQgPSAoKSA9PiB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9vd25lckNoZWNrcygpO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9saWtlQ291bnQpO1xuICAgIHRoaXMuX2xpa2VDb3VudEVsLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZUNvdW50O1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcil7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5faGFuZGxlWENsb3NlID0gdGhpcy5faGFuZGxlWENsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLm9wZW4gPSB0aGlzLm9wZW4uYmluZCh0aGlzKTtcclxuICAgIHRoaXMuY2xvc2UgPSB0aGlzLmNsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCl7XHJcbiAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpe1xyXG4gICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVhDbG9zZShldmVudCl7XHJcbiAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfb3BlbmVkJykgfHwgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlLWJ1dHRvbicpKXtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldmVudCl7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKXtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCl7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2hhbmRsZVhDbG9zZSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVFdmVudExpc3RlbmVycygpe1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9oYW5kbGVYQ2xvc2UpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQge1BvcHVwfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5leHBvcnQgY2xhc3MgUG9wdXBEZWxldGUgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwge2hhbmRsZUZvcm1TdW1iaXR9KXtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1bWJpdCA9IGhhbmRsZUZvcm1TdW1iaXQ7XHJcbiAgICB0aGlzLl9mb3JtU3VibWl0ID0gdGhpcy5fZm9ybVN1Ym1pdC5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihjYXJkSWQsIGNhcmRFbCl7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLl9jYXJkSWQgPSBjYXJkSWQ7XHJcbiAgICB0aGlzLl9jYXJkRWwgPSBjYXJkRWw7XHJcbiAgfVxyXG5cclxuICBfZm9ybVN1Ym1pdChldmVudCl7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1bWJpdCh0aGlzLl9jYXJkSWQsIHRoaXMuX2NhcmRFbCk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpe1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9mb3JtU3VibWl0KTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCl7XHJcbiAgICBzdXBlci5yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX2Zvcm1TdWJtaXQpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQge1BvcHVwfSBmcm9tICcuL1BvcHVwLmpzJztcclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3Ipe1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlUGljID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKVxyXG4gIH1cclxuXHJcbiAgb3BlbihuYW1lLCBsaW5rKXtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VQaWMuc3JjID0gbGluaztcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VQaWMuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcblxyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQge1BvcHVwfSBmcm9tICcuL1BvcHVwLmpzJztcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCB7aGFuZGxlRm9ybVN1bWJpdH0pe1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm1TdWJtaXQgPSB0aGlzLl9mb3JtU3VibWl0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1bWJpdCA9IGhhbmRsZUZvcm1TdW1iaXQ7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKTtcbiAgICB0aGlzLl9mb3JtSW5wdXRzID0gQXJyYXkuZnJvbSh0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pbnB1dCcpKTtcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcbiAgfVxuICBfZ2V0SW5wdXRWYWx1ZXMoKXtcbiAgICBjb25zdCBfaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIF9pbnB1dFZhbHVlc1tpbnB1dEVsLm5hbWVdID0gaW5wdXRFbC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gX2lucHV0VmFsdWVzO1xuICB9XG5cbiAgX3N1Ym1pdEJ0blRleHQodGV4dCl7XG4gICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gdGV4dDtcbiAgfVxuXG4gIF9mb3JtU3VibWl0KGV2ZW50KXtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGluaXRpYWxUZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xuXG4gICAgdGhpcy5fc3VibWl0QnRuVGV4dCgn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VtYml0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpXG4gICAgLnRoZW4oKCkgPT4gdGhpcy5jbG9zZSgpKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0blRleHQoaW5pdGlhbFRleHQpO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKXtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9mb3JtU3VibWl0KTtcbiAgfVxuXG5cbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKXtcbiAgICBzdXBlci5yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9mb3JtU3VibWl0KTtcbiAgfVxuXG4gIGNsb3NlKCl7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7cHJvZmlsZU5hbWVTZWxlY3RvciwgcHJvZmlsZUluZm9TZWxlY3RvciwgcHJvZmlsZVBpY3R1cmVTZWxlY3Rvcn0pe1xyXG4gICAgdGhpcy5fcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVOYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcHJvZmlsZUluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVJbmZvU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcHJvZmlsZVBpY3R1cmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVQaWN0dXJlU2VsZWN0b3IpO1xyXG4gIH1cclxuICBnZXRVc2VySW5mbygpe1xyXG4gICAgY29uc3QgcHJvZmlsZUluZm8gPSB7bmFtZUlucHV0OiB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCxcclxuICAgIGpvYklucHV0OiB0aGlzLl9wcm9maWxlSW5mby50ZXh0Q29udGVudH07XHJcbiAgICByZXR1cm4gcHJvZmlsZUluZm87XHJcbiAgfVxyXG4gIHNldFVzZXJJbmZvKHtuYW1lLCBhYm91dH0pe1xyXG4gICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcHJvZmlsZUluZm8udGV4dENvbnRlbnQgPSBhYm91dDtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoe2F2YXRhcn0pe1xyXG4gICAgdGhpcy5fcHJvZmlsZVBpY3R1cmUuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoY29uZmlnKXtcbiAgICB0aGlzLl91cmwgPSBjb25maWcudXJsO1xuICAgIHRoaXMuX2F1dGhvcml6YXRpb24gPSBjb25maWcuYXV0aG9yaXphdGlvbjtcbiAgICB0aGlzLl9jb2hvcnQgPSBjb25maWcuY29ob3J0O1xuICB9XG5cbiAgX3JlbmRlclJlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH12MS8ke3RoaXMuX2NvaG9ydH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb25cbiAgICAgIH1cbiAgICB9KVxuICAgIC50aGVuKHRoaXMuX3JlbmRlclJlc3BvbnNlKVxuICB9XG5cbiAgc2V0Q2FyZCh7bmFtZSwgbGlua30pe1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9djEvJHt0aGlzLl9jb2hvcnR9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmtcbiAgICAgIH0pXG4gICAgfSlcbiAgICAudGhlbih0aGlzLl9yZW5kZXJSZXNwb25zZSlcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKXtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfXYxLyR7dGhpcy5fY29ob3J0fS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uXG4gICAgICB9XG4gICAgfSlcbiAgICAudGhlbih0aGlzLl9yZW5kZXJSZXNwb25zZSlcbiAgfVxuXG4gIGdldFVzZXJEYXRhKCl7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH12MS8ke3RoaXMuX2NvaG9ydH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb25cbiAgICAgIH1cbiAgICB9KVxuICAgIC50aGVuKHRoaXMuX3JlbmRlclJlc3BvbnNlKVxuICB9XG5cbiAgc2V0VXNlckRhdGEoe25hbWUsIGFib3V0fSl7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH12MS8ke3RoaXMuX2NvaG9ydH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFib3V0XG4gICAgICB9KVxuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fcmVuZGVyUmVzcG9uc2UpXG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKHthdmF0YXJ9KXtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfXYxLyR7dGhpcy5fY29ob3J0fS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhclxuICAgICAgfSlcbiAgICB9KVxuICAgIC50aGVuKHRoaXMuX3JlbmRlclJlc3BvbnNlKVxuICB9XG5cblxuICBzZXRMaWtlKGNhcmRJZCl7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH12MS8ke3RoaXMuX2NvaG9ydH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgfVxuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fcmVuZGVyUmVzcG9uc2UpXG4gIH1cblxuICBkZWxldGVMaWtlKGNhcmRJZCl7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH12MS8ke3RoaXMuX2NvaG9ydH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgfVxuICAgIH0pXG4gICAgLnRoZW4odGhpcy5fcmVuZGVyUmVzcG9uc2UpXG4gIH1cbn1cblxuIiwiY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5jb25zdCBlZGl0QXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhcicpO1xyXG5jb25zdCBidG5BZGRDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuXHJcbmNvbnN0IHBvcHVwRWRpdFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfZWRpdC1wcm9maWxlJyk7XHJcbmNvbnN0IHBvcHVwRm9ybUVkaXRQcm9maWxlID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XHJcbmNvbnN0IGlucHV0RWRpdFByb2ZpbGVOYW1lID0gcG9wdXBFZGl0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X2RhdGFfbmFtZScpO1xyXG5jb25zdCBpbnB1dEVkaXRQcm9maWxlSm9iID0gcG9wdXBFZGl0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X2RhdGFfam9iJyk7XHJcblxyXG5cclxuY29uc3QgcG9wdXBFZGl0QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2VkaXQtYXZhdGFyJyk7XHJcblxyXG5jb25zdCBwb3B1cEFkZENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfYWRkLWNhcmQnKTtcclxuY29uc3QgcG9wdXBBZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiY2FyZC1mb3JtXCJdO1xyXG5jb25zdCBpbnB1dEFkZENhcmROYW1lID0gcG9wdXBBZGRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfZGF0YV9jYXJkLXRpdGxlJyk7XHJcbmNvbnN0IGlucHV0QWRkQ2FyZEltYWdlID0gcG9wdXBBZGRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfZGF0YV9pbWFnZScpO1xyXG5cclxuXHJcbmNvbnN0IHZhbGlkYXRpb25QYXJhbXMgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19idXR0b24nLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fYnV0dG9uX2Rpc2FibGVkJyxcclxuICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXQtZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXQtZXJyb3JfdmlzaWJsZSdcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICBlZGl0QnV0dG9uLFxyXG4gIGJ0bkFkZENhcmQsXHJcbiAgcG9wdXBGb3JtRWRpdFByb2ZpbGUsXHJcbiAgaW5wdXRFZGl0UHJvZmlsZU5hbWUsXHJcbiAgaW5wdXRFZGl0UHJvZmlsZUpvYixcclxuICBwb3B1cEFkZENhcmRGb3JtLFxyXG4gIGlucHV0QWRkQ2FyZE5hbWUsXHJcbiAgaW5wdXRBZGRDYXJkSW1hZ2UsXHJcbiAgdmFsaWRhdGlvblBhcmFtcyxcclxuICBlZGl0QXZhdGFyQnV0dG9uLFxyXG4gIHBvcHVwRWRpdEF2YXRhclxyXG59O1xyXG4iLCJpbXBvcnQgeyBpbml0aWFsQ2FyZHMgfSBmcm9tIFwiLi4vdXRpbHMvY2FyZHNBcnJheS5qc1wiO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uICBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHsgUG9wdXB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQgeyBQb3B1cERlbGV0ZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwRGVsZXRlLmpzXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IHsgQXBpIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQge2VkaXRCdXR0b24sXG4gIGJ0bkFkZENhcmQsXG4gIHBvcHVwRm9ybUVkaXRQcm9maWxlLFxuICBpbnB1dEVkaXRQcm9maWxlTmFtZSxcbiAgaW5wdXRFZGl0UHJvZmlsZUpvYixcbiAgcG9wdXBBZGRDYXJkRm9ybSxcbiAgaW5wdXRBZGRDYXJkTmFtZSxcbiAgaW5wdXRBZGRDYXJkSW1hZ2UsXG4gIHZhbGlkYXRpb25QYXJhbXMsXG4gIGVkaXRBdmF0YXJCdXR0b24sXG4gIHBvcHVwRWRpdEF2YXRhcn0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcbmltcG9ydCAnLi9pbmRleC5jc3MnO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgdXJsOiBcImh0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby9cIixcbiAgYXV0aG9yaXphdGlvbjogXCJjMGU1NjM0MC1kNGI0LTQwZjMtOTk2ZC03ODBlNmNhOWM0NGVcIixcbiAgY29ob3J0OiBcImNvaG9ydC02MFwiXG59KTtcbmxldCB1c2VySWQ7XG5sZXQgY2FyZHNMaXN0O1xuXG5cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChuYW1lLCBsaW5rLCBjYXJkT3duZXJJZCwgdXNlcklkLCBjYXJkSWQsIGxpa2VDb3VudCkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQobmFtZSwgbGluaywgXCIjY2FyZFwiLCBoYW5kbGVDYXJkQ2xpY2ssIGNhcmRPd25lcklkLCB1c2VySWQsIGNhcmRJZCwgaGFuZGxlRGVsZXRlQ2FyZCwgbGlrZUNvdW50LCBoYW5kbGVMaWtlQ2xpY2spO1xuICBjb25zdCBjYXJkRWwgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xuICByZXR1cm4gY2FyZEVsO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVDYXJkQ2xpY2sobmFtZSwgbGluaykge1xuICBpbWFnZURlZmF1bHRQb3B1cC5vcGVuKG5hbWUsIGxpbmspO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRJZCwgY2FyZEVsKSB7XG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKGNhcmRJZCwgY2FyZEVsKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmRJZCwgaXNMaWtlZCwgY2FyZEVsKSB7XG4gIGlmIChpc0xpa2VkKSB7XG4gICAgYXBpLmRlbGV0ZUxpa2UoY2FyZElkKVxuICAgIC50aGVuKChlbGVtZW50KSA9PntcbiAgICAgIGNhcmRFbC51bmxpa2VDbGljayhlbGVtZW50Lmxpa2VzLmxlbmd0aCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBhcGkuc2V0TGlrZShjYXJkSWQpXG4gICAgLnRoZW4oKGVsZW1lbnQpID0+e1xuICAgICAgY2FyZEVsLmxpa2VDbGljayhlbGVtZW50Lmxpa2VzLmxlbmd0aCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbnNlcnRQcm9maWxlSW5mbyh7bmFtZUlucHV0LCBqb2JJbnB1dH0pIHtcbiAgaW5wdXRFZGl0UHJvZmlsZU5hbWUudmFsdWUgPSBuYW1lSW5wdXQ7XG4gIGlucHV0RWRpdFByb2ZpbGVKb2IudmFsdWUgPSBqb2JJbnB1dDtcbn1cblxuXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBjb25zdCBkYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgaW5zZXJ0UHJvZmlsZUluZm8oZGF0YSk7XG4gIHByb2ZpbGVWYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xuICBwcm9maWxlVmFsaWRhdGlvbi5kaXNhYmxlU3VibWl0QnRuKCk7XG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XG59KTtcblxuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgYXZhdGFyVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb24oKTtcbiAgYXZhdGFyVmFsaWRhdGlvbi5kaXNhYmxlU3VibWl0QnRuKCk7XG4gIHByb2ZpbGVBdmF0YXJQb3B1cC5vcGVuKCk7XG59KTtcblxuYnRuQWRkQ2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgYWRkQ2FyZFZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGNhcmRQb3B1cC5vcGVuKCk7XG59KTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe3Byb2ZpbGVOYW1lU2VsZWN0b3I6ICcucHJvZmlsZV9fdGl0bGUnLFxuICBwcm9maWxlSW5mb1NlbGVjdG9yOiAnLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyxcbiAgcHJvZmlsZVBpY3R1cmVTZWxlY3RvcjogJy5wcm9maWxlX19waWN0dXJlJ1xufSk7XG5cbmNvbnN0IHByb2ZpbGVWYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblBhcmFtcywgcG9wdXBGb3JtRWRpdFByb2ZpbGUpO1xucHJvZmlsZVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhZGRDYXJkVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25QYXJhbXMsIHBvcHVwQWRkQ2FyZEZvcm0pO1xuYWRkQ2FyZFZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhdmF0YXJWYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblBhcmFtcywgcG9wdXBFZGl0QXZhdGFyKTtcbmF2YXRhclZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5cbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfZWRpdC1wcm9maWxlJywge2hhbmRsZUZvcm1TdW1iaXQ6ICh7am9iLCBmdWxsTmFtZX0pID0+IHtcbiAgcmV0dXJuIGFwaS5zZXRVc2VyRGF0YSh7XG4gICAgbmFtZTogZnVsbE5hbWUsXG4gICAgYWJvdXQ6IGpvYlxuICB9KVxuICAudGhlbigoKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZTogZnVsbE5hbWUsXG4gICAgICBhYm91dDogam9iXG4gICAgfSk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG59fSk7XG5cbmNvbnN0IHByb2ZpbGVBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfZWRpdC1hdmF0YXInLCB7aGFuZGxlRm9ybVN1bWJpdDogKHthdmF0YXJ9KSA9PiB7XG4gIHJldHVybiBhcGkuc2V0VXNlckF2YXRhcih7YXZhdGFyfSlcbiAgLnRoZW4oKCkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoe2F2YXRhcn0pO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pXG59fSk7XG5cbmNvbnN0IGNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfYWRkLWNhcmQnLCB7aGFuZGxlRm9ybVN1bWJpdDogKCkgPT4ge1xuICBjb25zdCBuYW1lID0gaW5wdXRBZGRDYXJkTmFtZS52YWx1ZTtcbiAgY29uc3QgbGluayA9IGlucHV0QWRkQ2FyZEltYWdlLnZhbHVlO1xuICByZXR1cm4gYXBpLnNldENhcmQoe25hbWUsIGxpbmt9KVxuICAudGhlbigoZWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IGNhcmRFbCA9IGNyZWF0ZUNhcmQoZWxlbWVudC5uYW1lLCBlbGVtZW50LmxpbmssIGVsZW1lbnQub3duZXIuX2lkLCB1c2VySWQsIGVsZW1lbnQuX2lkLCBlbGVtZW50Lmxpa2VzKTtcblxuICAgIGNhcmRzTGlzdC5zZXRJdGVtKGNhcmRFbCk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSlcbn19KTtcblxuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwRGVsZXRlKCcucG9wdXBfZGVsZXRlLWNhcmQnLCB7aGFuZGxlRm9ybVN1bWJpdDogKGNhcmRJZCwgY2FyZEVsKSA9PiB7XG4gIGFwaS5kZWxldGVDYXJkKGNhcmRJZClcbiAgLnRoZW4oKCkgPT4ge1xuICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xuICAgIGNhcmRFbC5yZW1vdmUoKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xuICB9KTtcbn19KTtcblxuY29uc3QgaW1hZ2VEZWZhdWx0UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF9sYXJnZS1pbWFnZScpO1xuXG5cbmNvbnN0IHVzZXJQcm9taXNlID0gYXBpLmdldFVzZXJEYXRhKCk7XG5jb25zdCBjYXJkUHJvbWlzZSA9IGFwaS5nZXRJbml0aWFsQ2FyZHMoKTtcblxuUHJvbWlzZS5hbGwoW3VzZXJQcm9taXNlLCBjYXJkUHJvbWlzZV0pXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIodXNlckRhdGEpO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XG5cblxuXG4gICAgY2FyZHNMaXN0ID0gbmV3IFNlY3Rpb24oe1xuICAgICAgZGF0YTogY2FyZHMsXG4gICAgICByZW5kZXJlcjogKGVsZW1lbnQpID0+IHtcbiAgICAgICAgY29uc3QgY2FyZEVsID0gY3JlYXRlQ2FyZChlbGVtZW50Lm5hbWUsIGVsZW1lbnQubGluaywgZWxlbWVudC5vd25lci5faWQsIHVzZXJJZCwgZWxlbWVudC5faWQsIGVsZW1lbnQubGlrZXMpO1xuICAgICAgICBjYXJkc0xpc3Quc2V0SXRlbShjYXJkRWwpO1xuICAgICAgfSxcbiAgICB9LCAnLmNhcmRzLWdyaWQnKTtcbiAgICBjYXJkc0xpc3QucmVuZGVySXRlbXMoKTtcbiAgfSlcbiAgLmNhdGNoKGVyciA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG4iXSwibmFtZXMiOlsiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm1FbGVtZW50IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsIl9mb3JtRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfY29uZmlnIiwiaW5wdXRTZWxlY3RvciIsIl9idXR0b25Gb3JtIiwicXVlcnlTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImlucHV0RWwiLCJhZGRFdmVudExpc3RlbmVyIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlU3VibWl0QnRuIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInJlbW92ZUF0dHJpYnV0ZSIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbCIsImlkIiwidGV4dENvbnRlbnQiLCJhZGQiLCJlcnJvckNsYXNzIiwiX2hpZGVJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfc2hvd0lucHV0RXJyb3IiLCJ0aGlzIiwic2V0QXR0cmlidXRlIiwiaW5wdXRFbGVtZW50IiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiZGF0YSIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZG9jdW1lbnQiLCJlbGVtZW50IiwicHJlcGVuZCIsImlubmVySFRNTCIsImNsZWFyIiwiaXRlbSIsIkNhcmQiLCJuYW1lIiwibGluayIsInRlbXBsYXRlU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJjYXJkT3duZXJJZCIsInVzZXJJZCIsImNhcmRJZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJsaWtlQ291bnQiLCJoYW5kbGVMaWtlQ2xpY2siLCJfdGVtcGxhdGVTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZEltYWdlIiwiX2VsZW1lbnQiLCJfY2FyZFRpdGxlIiwiX2xpa2VCdG4iLCJfbGlrZUNvdW50RWwiLCJfdHJhc2hCdG4iLCJfaGFuZGxlQ2FyZENsaWNrIiwiX25hbWUiLCJfbGluayIsIl9saWtlQ2FyZCIsIl9nZXRUZW1wbGF0ZSIsIl9vd25lckNoZWNrcyIsImFsdCIsInNyYyIsImNvbnNvbGUiLCJsb2ciLCJfbGlrZUNvdW50IiwiYmluZCIsIl9kZWxldGVDYXJkIiwiX2lzT3duZXIiLCJfdXNlcklkIiwiX2NhcmRJZCIsIl9oYW5kbGVEZWxldGVDYXJkIiwibGVuZ3RoIiwiX2xpa2VzIiwiX2hhbmRsZUxpa2VDbGljayIsImlzTGlrZWQiLCJjb250YWlucyIsImxpa2VzIiwiX2lkIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsIl9oYW5kbGVYQ2xvc2UiLCJvcGVuIiwiY2xvc2UiLCJzZXRFdmVudExpc3RlbmVycyIsInJlbW92ZUV2ZW50TGlzdGVuZXJzIiwiZXZlbnQiLCJ0YXJnZXQiLCJrZXkiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9wdXBEZWxldGUiLCJoYW5kbGVGb3JtU3VtYml0IiwiX2hhbmRsZUZvcm1TdW1iaXQiLCJfZm9ybVN1Ym1pdCIsImNhcmRFbCIsIl9jYXJkRWwiLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwV2l0aEltYWdlIiwiX3BvcHVwSW1hZ2VQaWMiLCJfcG9wdXBDYXB0aW9uIiwiUG9wdXBXaXRoRm9ybSIsIl9wb3B1cEZvcm0iLCJfZm9ybUlucHV0cyIsIl9zdWJtaXRCdG4iLCJfaW5wdXRWYWx1ZXMiLCJ2YWx1ZSIsInRleHQiLCJpbml0aWFsVGV4dCIsIl9zdWJtaXRCdG5UZXh0IiwiX2dldElucHV0VmFsdWVzIiwidGhlbiIsImZpbmFsbHkiLCJyZXNldCIsIlVzZXJJbmZvIiwicHJvZmlsZU5hbWVTZWxlY3RvciIsInByb2ZpbGVJbmZvU2VsZWN0b3IiLCJwcm9maWxlUGljdHVyZVNlbGVjdG9yIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVJbmZvIiwiX3Byb2ZpbGVQaWN0dXJlIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJhYm91dCIsImF2YXRhciIsIkFwaSIsIl91cmwiLCJ1cmwiLCJfYXV0aG9yaXphdGlvbiIsImF1dGhvcml6YXRpb24iLCJfY29ob3J0IiwiY29ob3J0IiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwiaGVhZGVycyIsIl9yZW5kZXJSZXNwb25zZSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEJ1dHRvbiIsImVkaXRBdmF0YXJCdXR0b24iLCJidG5BZGRDYXJkIiwicG9wdXBFZGl0UHJvZmlsZSIsInBvcHVwRm9ybUVkaXRQcm9maWxlIiwiZm9ybXMiLCJpbnB1dEVkaXRQcm9maWxlTmFtZSIsImlucHV0RWRpdFByb2ZpbGVKb2IiLCJwb3B1cEVkaXRBdmF0YXIiLCJwb3B1cEFkZENhcmQiLCJwb3B1cEFkZENhcmRGb3JtIiwiaW5wdXRBZGRDYXJkTmFtZSIsImlucHV0QWRkQ2FyZEltYWdlIiwidmFsaWRhdGlvblBhcmFtcyIsImlucHV0RXJyb3JDbGFzcyIsImNhcmRzTGlzdCIsImFwaSIsImNyZWF0ZUNhcmQiLCJnZW5lcmF0ZUNhcmQiLCJpbWFnZURlZmF1bHRQb3B1cCIsImRlbGV0ZUNhcmRQb3B1cCIsImRlbGV0ZUxpa2UiLCJ1bmxpa2VDbGljayIsImNhdGNoIiwiZXJyIiwic2V0TGlrZSIsImxpa2VDbGljayIsInVzZXJJbmZvIiwiZ2V0VXNlckluZm8iLCJwcm9maWxlVmFsaWRhdGlvbiIsInJlc2V0VmFsaWRhdGlvbiIsInByb2ZpbGVQb3B1cCIsImF2YXRhclZhbGlkYXRpb24iLCJwcm9maWxlQXZhdGFyUG9wdXAiLCJhZGRDYXJkVmFsaWRhdGlvbiIsImNhcmRQb3B1cCIsImVuYWJsZVZhbGlkYXRpb24iLCJqb2IiLCJmdWxsTmFtZSIsInNldFVzZXJEYXRhIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwic2V0Q2FyZCIsIm93bmVyIiwic2V0SXRlbSIsImRlbGV0ZUNhcmQiLCJ1c2VyUHJvbWlzZSIsImdldFVzZXJEYXRhIiwiY2FyZFByb21pc2UiLCJnZXRJbml0aWFsQ2FyZHMiLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwicmVuZGVySXRlbXMiXSwic291cmNlUm9vdCI6IiJ9